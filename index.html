<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>FPS Arena</title>
<style>
body { margin:0; overflow:hidden; background:#bbb; }
#hud {
  position:fixed;
  top:10px; left:10px;
  font-family:Arial;
  color:#000;
  font-size:18px;
}
#crosshair {
  position:fixed;
  top:50%; left:50%;
  transform:translate(-50%,-50%);
  font-size:24px;
}
#fire {
  position:fixed;
  bottom:40px; right:40px;
  width:80px; height:80px;
  border-radius:50%;
  background:darkred;
  color:white;
  font-size:24px;
}
#reload {
  position:fixed;
  bottom:140px; right:40px;
  width:80px; height:50px;
}
#joy {
  position:fixed;
  bottom:40px; left:40px;
  width:120px; height:120px;
  border-radius:50%;
  background:rgba(0,0,0,.2);
}
</style>
</head>
<body>

<div id="hud">‚ù§Ô∏è Vida: <span id="life">100</span> | üî´ <span id="weapon">Rifle</span></div>
<div id="crosshair">+</div>
<div id="joy"></div>
<button id="fire">üî´</button>
<button id="reload">‚ü≥</button>

<script src="https://cdn.jsdelivr.net/npm/three@0.152.2/build/three.min.js"></script>

<script>
const scene = new THREE.Scene();
scene.background = new THREE.Color(0xcccccc);

const camera = new THREE.PerspectiveCamera(75, innerWidth/innerHeight, 0.1, 1000);
camera.position.y = 1.6;

const renderer = new THREE.WebGLRenderer({antialias:true});
renderer.setSize(innerWidth, innerHeight);
document.body.appendChild(renderer.domElement);

const light = new THREE.HemisphereLight(0xffffff,0x444444);
scene.add(light);

// ch√£o
const floor = new THREE.Mesh(
  new THREE.PlaneGeometry(50,50),
  new THREE.MeshStandardMaterial({color:0x999999})
);
floor.rotation.x = -Math.PI/2;
scene.add(floor);

// paredes
function wall(x,z,w,d){
  const m = new THREE.Mesh(
    new THREE.BoxGeometry(w,3,d),
    new THREE.MeshStandardMaterial({color:0x666666})
  );
  m.position.set(x,1.5,z);
  scene.add(m);
}
wall(0,-10,20,1);
wall(0,10,20,1);
wall(-10,0,1,20);
wall(10,0,1,20);
wall(0,0,4,4);

// arma
let ammo = 30, reloading=false;
document.getElementById("fire").onclick = () => {
  if(ammo>0 && !reloading){
    ammo--;
  }
}
document.getElementById("reload").onclick = () => {
  if(!reloading){
    reloading=true;
    setTimeout(()=>{ ammo=30; reloading=false; },1500);
  }
}

// movimento
let move = {x:0,z:0};
const speed = 0.08;

const joy = document.getElementById("joy");
joy.addEventListener("touchmove",e=>{
  const r = joy.getBoundingClientRect();
  const x = e.touches[0].clientX - r.left - r.width/2;
  const y = e.touches[0].clientY - r.top - r.height/2;
  move.x = x/60;
  move.z = y/60;
});

document.addEventListener("mousemove",e=>{
  camera.rotation.y -= e.movementX * 0.002;
});

document.body.addEventListener("click",()=>renderer.domElement.requestPointerLock());

function loop(){
  camera.position.x += Math.sin(camera.rotation.y)*-move.z*speed;
  camera.position.z += Math.cos(camera.rotation.y)*-move.z*speed;
  camera.position.x += Math.cos(camera.rotation.y)*move.x*speed;
  camera.position.z -= Math.sin(camera.rotation.y)*move.x*speed;

  renderer.render(scene,camera);
  requestAnimationFrame(loop);
}
loop();
</script>
</body>
</html>
