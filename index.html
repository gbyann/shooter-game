<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8" />
<title>FPS Competitivo</title>
<style>
html, body {
  margin: 0;
  padding: 0;
  overflow: hidden;
  background: #e5e5e5;
  font-family: Arial, sans-serif;
}

#hud {
  position: fixed;
  top: 10px;
  left: 10px;
  color: #000;
  font-weight: bold;
  z-index: 10;
}

#crosshair {
  position: fixed;
  top: 50%;
  left: 50%;
  width: 20px;
  height: 20px;
  margin-left: -10px;
  margin-top: -10px;
  pointer-events: none;
}

#crosshair::before,
#crosshair::after {
  content: "";
  position: absolute;
  background: black;
}

#crosshair::before {
  width: 2px;
  height: 20px;
  left: 9px;
}

#crosshair::after {
  height: 2px;
  width: 20px;
  top: 9px;
}

.btn {
  position: fixed;
  width: 60px;
  height: 60px;
  border-radius: 50%;
  border: none;
  background: rgba(0,0,0,0.6);
  color: white;
  font-size: 20px;
}

#fw { bottom: 120px; left: 80px; }
#bw { bottom: 20px; left: 80px; }
#lt { bottom: 70px; left: 20px; }
#rt { bottom: 70px; left: 140px; }
#fire { bottom: 70px; right: 40px; background: darkred; }
</style>
</head>

<body>
<div id="hud">‚ù§Ô∏è Vida: <span id="life">100</span></div>
<div id="crosshair"></div>

<button id="fw" class="btn">‚ñ≤</button>
<button id="bw" class="btn">‚ñº</button>
<button id="lt" class="btn">‚óÄ</button>
<button id="rt" class="btn">‚ñ∂</button>
<button id="fire" class="btn">üî´</button>

<script src="https://cdn.jsdelivr.net/npm/three@0.152.2/build/three.min.js"></script>

<script>
const scene = new THREE.Scene();
scene.background = new THREE.Color(0xe5e5e5);

const camera = new THREE.PerspectiveCamera(75, innerWidth/innerHeight, 0.1, 1000);
camera.position.set(0, 1.6, 5);

const renderer = new THREE.WebGLRenderer({ antialias: true });
renderer.setSize(innerWidth, innerHeight);
document.body.appendChild(renderer.domElement);

// Luz
scene.add(new THREE.AmbientLight(0xffffff, 0.8));
const dirLight = new THREE.DirectionalLight(0xffffff, 0.5);
dirLight.position.set(5,10,5);
scene.add(dirLight);

// Ch√£o
const floor = new THREE.Mesh(
  new THREE.PlaneGeometry(50,50),
  new THREE.MeshStandardMaterial({ color: 0xcccccc })
);
floor.rotation.x = -Math.PI/2;
scene.add(floor);

// ===== MAPA CS-STYLE (ORIGINAL) =====
const walls = [];
function wall(x,z,w,d){
  const m = new THREE.Mesh(
    new THREE.BoxGeometry(w,3,d),
    new THREE.MeshStandardMaterial({ color: 0x999999 })
  );
  m.position.set(x,1.5,z);
  scene.add(m);
  walls.push(m);
}

wall(0,-10,20,1);
wall(0,10,20,1);
wall(-10,0,1,20);
wall(10,0,1,20);

wall(0,0,6,1);
wall(-5,3,1,6);
wall(5,-3,1,6);

// ===== PLAYER =====
let life = 100;
let velocity = { x:0, z:0 };
let yaw = 0;

const keys = {};
document.addEventListener("keydown", e => keys[e.key] = true);
document.addEventListener("keyup", e => keys[e.key] = false);

// Mouse PC
document.addEventListener("mousemove", e => {
  if (document.pointerLockElement === document.body) {
    yaw -= e.movementX * 0.002;
    camera.rotation.y = yaw;
  }
});

document.body.addEventListener("click", () => {
  document.body.requestPointerLock();
});

// Mobile
fw.ontouchstart = () => keys["w"] = true;
bw.ontouchstart = () => keys["s"] = true;
lt.ontouchstart = () => keys["a"] = true;
rt.ontouchstart = () => keys["d"] = true;

fw.ontouchend = bw.ontouchend =
lt.ontouchend = rt.ontouchend = () => keys = {};

// ===== TIRO =====
const bullets = [];
fire.onclick = shoot;
document.addEventListener("mousedown", shoot);

function shoot(){
  const geo = new THREE.SphereGeometry(0.05,8,8);
  const mat = new THREE.MeshBasicMaterial({ color: 0x000000 });
  const b = new THREE.Mesh(geo,mat);
  b.position.copy(camera.position);
  b.dir = new THREE.Vector3(
    -Math.sin(yaw),0,-Math.cos(yaw)
  );
  scene.add(b);
  bullets.push(b);
}

// ===== LOOP =====
function animate(){
  requestAnimationFrame(animate);

  const speed = 0.08;
  if(keys["w"]) velocity.z = -speed;
  if(keys["s"]) velocity.z = speed;
  if(keys["a"]) velocity.x = -speed;
  if(keys["d"]) velocity.x = speed;

  camera.position.x += Math.sin(yaw)*velocity.z + Math.cos(yaw)*velocity.x;
  camera.position.z += Math.cos(yaw)*velocity.z - Math.sin(yaw)*velocity.x;

  velocity.x *= 0.8;
  velocity.z *= 0.8;

  bullets.forEach(b=>{
    b.position.add(b.dir.clone().multiplyScalar(0.5));
  });

  renderer.render(scene,camera);
}

animate();
</script>
</body>
</html>
