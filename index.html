<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>FPS Web ‚Äì Armas</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
html,body{margin:0;overflow:hidden;background:#bfbfbf;font-family:Arial}
#hud{position:fixed;top:10px;left:10px;color:#000;font-weight:bold;z-index:10}
#weapon{position:fixed;bottom:10px;left:10px;color:#000;font-weight:bold}
#cross{position:fixed;left:50%;top:50%;width:18px;height:18px;margin:-9px 0 0 -9px;pointer-events:none}
#cross:before,#cross:after{content:"";position:absolute;background:#000}
#cross:before{width:2px;height:18px;left:8px}
#cross:after{height:2px;width:18px;top:8px}
#fire{position:fixed;bottom:20px;right:20px;width:70px;height:70px;border-radius:50%;border:none;background:#900;color:#fff;font-size:22px}
</style>
</head>
<body>

<div id="hud">‚ù§Ô∏è Vida: <span id="life">100</span></div>
<div id="weapon">üî´ Pistola</div>
<div id="cross"></div>
<button id="fire">üî´</button>

<script src="https://cdn.jsdelivr.net/npm/three@0.152.2/build/three.min.js"></script>

<script>
/* ===== CENA ===== */
const scene=new THREE.Scene();
scene.background=new THREE.Color(0xbfbfbf);

const camera=new THREE.PerspectiveCamera(75,innerWidth/innerHeight,0.1,1000);
camera.position.set(0,1.6,5);

const renderer=new THREE.WebGLRenderer({antialias:true});
renderer.setSize(innerWidth,innerHeight);
document.body.appendChild(renderer.domElement);

/* ===== LUZ ===== */
scene.add(new THREE.AmbientLight(0xffffff,0.7));
const light=new THREE.DirectionalLight(0xffffff,0.5);
light.position.set(5,10,5);
scene.add(light);

/* ===== CH√ÉO ===== */
const floor=new THREE.Mesh(
  new THREE.PlaneGeometry(100,100),
  new THREE.MeshStandardMaterial({color:0xaaaaaa})
);
floor.rotation.x=-Math.PI/2;
scene.add(floor);

/* ===== ALVOS (TESTE DE TIRO) ===== */
const targets=[];
for(let i=0;i<5;i++){
  const t=new THREE.Mesh(
    new THREE.BoxGeometry(1,1.8,1),
    new THREE.MeshStandardMaterial({color:0xaa0000})
  );
  t.position.set(Math.random()*10-5,0.9,Math.random()*-10);
  scene.add(t);
  targets.push(t);
}

/* ===== PLAYER ===== */
let life=100;
let yaw=0,pitch=0;
let canShoot=true;

/* ===== ARMAS ===== */
const weapons={
  pistol:{name:"Pistola",damage:25,rate:400,recoil:0.02},
  rifle:{name:"Rifle",damage:15,rate:120,recoil:0.04}
};
let currentWeapon=weapons.pistol;

/* ===== INPUT ===== */
const keys={};
addEventListener("keydown",e=>{
  keys[e.key]=true;
  if(e.key==="1"){currentWeapon=weapons.pistol;weapon.innerText="üî´ Pistola";}
  if(e.key==="2"){currentWeapon=weapons.rifle;weapon.innerText="üî´ Rifle";}
});
addEventListener("keyup",e=>keys[e.key]=false);

/* ===== MOUSE (PC) ===== */
addEventListener("mousemove",e=>{
  if(document.pointerLockElement===document.body){
    yaw-=e.movementX*0.002;
    pitch-=e.movementY*0.002;
    pitch=Math.max(-1.2,Math.min(1.2,pitch));
    camera.rotation.set(pitch,yaw,0);
  }
});
document.body.onclick=()=>document.body.requestPointerLock();

/* ===== MOBILE TIRO ===== */
fire.onclick=shoot;

/* ===== TIRO (RAYCAST) ===== */
const raycaster=new THREE.Raycaster();
function shoot(){
  if(!canShoot) return;
  canShoot=false;
  setTimeout(()=>canShoot=true,currentWeapon.rate);

  pitch-=currentWeapon.recoil;

  raycaster.setFromCamera(new THREE.Vector2(0,0),camera);
  const hits=raycaster.intersectObjects(targets);

  if(hits.length){
    const hit=hits[0].object;
    hit.material.color.set(0x333333);
    scene.remove(hit);
    targets.splice(targets.indexOf(hit),1);
  }
}

/* ===== LOOP ===== */
function animate(){
  requestAnimationFrame(animate);

  const speed=0.08;
  if(keys["w"]){camera.position.x+=Math.sin(yaw)*speed;camera.position.z+=Math.cos(yaw)*speed;}
  if(keys["s"]){camera.position.x-=Math.sin(yaw)*speed;camera.position.z-=Math.cos(yaw)*speed;}
  if(keys["a"]){camera.position.x+=Math.sin(yaw-Math.PI/2)*speed;camera.position.z+=Math.cos(yaw-Math.PI/2)*speed;}
  if(keys["d"]){camera.position.x+=Math.sin(yaw+Math.PI/2)*speed;camera.position.z+=Math.cos(yaw+Math.PI/2)*speed;}

  document.getElementById("life").innerText=life;
  renderer.render(scene,camera);
}
animate();
</script>
</body>
</html>
